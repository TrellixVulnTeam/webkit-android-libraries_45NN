set(SQLITE_SOURCES
	sqlite3.c
)

set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -lpthread -O3")
add_definitions(-DNDEBUG=1 -DHAVE_USLEEP=1 -DSQLITE_DEFAULT_JOURNAL_SIZE_LIMIT=1048576 -DSQLITE_THREADSAFE=1 -DSQLITE_ENABLE_MEMORY_MANAGEMENT=1 -DSQLITE_DEFAULT_AUTOVACUUM=1 -DSQLITE_TEMP_STORE=3 -DSQLITE_ENABLE_FTS3 -DSQLITE_ENABLE_FTS3_BACKWARDS -DSQLITE_DEFAULT_FILE_FORMAT=4)

INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR}
	dist
	${ICU_INCLUDE_DIRS}
)

set(LIBRARY_DEPS
	icu4c
)

add_library(sqlite STATIC ${SQLITE_SOURCES})

#link the module like any other
target_link_libraries(sqlite ${LIBRARY_DEPS})

add_post_build_command(sqlite)

set(SQLITE_LIBRARY_HEADERS
    sqlite3.h
)

copy_library_headers(sqlite "${SQLITE_LIBRARY_HEADERS}" include)
